#!/usr/bin/env node

!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=6)}([function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("es6-promisify")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={filepath:process.env.NODE_HIDE_FILEPATH||process.env["win32"==process.platform?"USERPROFILE":"HOME"],filename:process.env.NODE_HIDE_FILENAME||"__node-hide-accounts",cryptography:{algorithm:process.env.CRYPT_ALGORITHM||"aes-256-ctr",password:process.env.CRYPT_SECRET}}},function(e,t){e.exports=require("path")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(0)),a=i(r(3)),u=i(r(1)),o=i(r(5)),s=i(r(2));function i(e){return e&&e.__esModule?e:{default:e}}function c(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,u){try{var o=t[a](u),s=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}var l=(0,u.default)(n.default.mkdir),f=(0,u.default)(n.default.writeFile),d=(0,u.default)(n.default.readFile),p=(0,o.default)();t.default={filepath:a.default.join(s.default.filepath,s.default.filename),upgradeFrom3To4(){var e=this;return c(regeneratorRuntime.mark(function t(){var r,n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.doesDirectoryExist(s.default.filepath)){t.next=13;break}if(!e.doesFileExist(e.filepath)){t.next=13;break}return t.next=4,d(e.filepath);case 4:return r=t.sent,t.next=7,p.parseData(r.toString("utf8"),!1);case 7:if(1!==(n=t.sent).toString("utf8").split(":").length){t.next=13;break}return a=JSON.parse(p.deprecated.decrypt(n.toString("utf8"))),t.next=12,e.writeObjToFile(a);case 12:return t.abrupt("return",!0);case 13:return t.abrupt("return",!1);case 14:case"end":return t.stop()}},t,e)}))()},getAndDecryptFlatFile(){var e=this;return c(regeneratorRuntime.mark(function t(){var r,n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.doesDirectoryExist(s.default.filepath)){t.next=25;break}if(!e.doesFileExist(e.filepath)){t.next=22;break}return t.next=4,d(e.filepath);case 4:if(0!==(r=t.sent).length){t.next=9;break}return t.abrupt("return",null);case 9:return t.next=11,p.parseData(r.toString("utf8"),!1);case 11:return n=t.sent,t.prev=12,a=JSON.parse(p.decrypt(n.toString("utf8"))),t.abrupt("return",a);case 17:throw t.prev=17,t.t0=t.catch(12),`We're having a problem parsing your flat file at '${e.filepath}'.\n              This is likely due to a different master password, environment variable CRYPT_SECRET,\n              being used that previously was set. Make sure you have the correct\n              secret you used before and try again.`.replace(/\n\s+/g,"\n");case 20:t.next=25;break;case 22:return t.next=24,f(e.filepath,"");case 24:return t.abrupt("return",null);case 25:return t.next=27,l(s.default.filepath);case 27:return t.next=29,f(e.filepath,"");case 29:return t.abrupt("return","");case 30:case"end":return t.stop()}},t,e,[[12,17]])}))()},writeObjToFile(e){var t=arguments,r=this;return c(regeneratorRuntime.mark(function n(){var a,u,o,s=t.length>1&&void 0!==t[1]?t[1]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=Object.assign(s,e),u=p.encrypt(JSON.stringify(a)),t.next=4,p.parseData(u);case 4:return o=t.sent,t.next=7,f(r.filepath,o);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}},n,r)}))()},doesDirectoryExist(e){try{return n.default.statSync(e).isDirectory()}catch(e){return!1}},doesFileExist(e){try{return n.default.statSync(e).isFile()}catch(e){return!1}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,u=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,u=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw u}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.algorithm||i.default.cryptography.algorithm,r=e.secret||i.default.cryptography.password;return{_algorithm:t,_secret:r,encrypt(e){var t=function(e){return{iv:a.default.randomBytes(16),key:e instanceof Buffer?e:Buffer.from(e)}}(h(this._secret,this.getAlgorithmKeyLength())),r=t.iv,n=t.key,u=a.default.createCipheriv(this._algorithm,n,r),o=u.update(e,"utf8","hex");return`${o+=u.final("hex")}:${r.toString("hex")}`},encryptFileUtf8(e){var t=this;return l(regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return console.log("filePath",e),r.next=3,f(e,{encoding:"utf8"});case 3:return n=r.sent,r.next=6,t.encrypt(n);case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}},r,t)}))()},decrypt(e){var t=e.split(":"),r=n(t,2),u=r[0],o=r[1],s=Buffer.from(o,"hex"),i=h(this._secret,this.getAlgorithmKeyLength()),c=i instanceof Buffer?i:Buffer.from(i),l=a.default.createDecipheriv(this._algorithm,c,s);return l.update(u,"hex","utf8")+l.final("utf8")},decryptFileUtf8(e){var t=this;return l(regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,f(e,{encoding:"utf8"});case 2:return n=r.sent,r.next=5,t.decrypt(n);case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}},r,t)}))()},stringToHash(e){var t=a.default.createHash("md5");return t.update(e),t.digest("hex")},fileToHash(e){var t=this;return l(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise(function(t,r){var n=a.default.createHash("md5"),o=u.default.ReadStream(e);o.on("data",function(e){return n.update(e)}),o.on("error",r),o.on("end",function(){return t(n.digest("hex"))})});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},r,t)}))()},parseData(e){var t=arguments,r=this;return l(regeneratorRuntime.mark(function n(){var a,u=!(t.length>1&&void 0!==t[1])||t[1];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=u,t.next=!1===t.t0?4:7;break;case 4:return t.next=6,d(Buffer.from(e,"base64"));case 6:return t.abrupt("return",t.sent);case 7:return t.next=9,p(e);case 9:return a=t.sent,t.abrupt("return",Buffer.from(a).toString("base64"));case 11:case"end":return t.stop()}},n,r)}))()},getAlgorithmKeyLength(){return{"des-ede3":24,aes128:16,"aes-128-cbc":16,aes192:24,aes256:32}[this._algorithm]},deprecated:{_algorithm:t,_secret:r,encrypt(e){var t=a.default.createCipher(this._algorithm,this._secret);return t.update(e,"utf8","hex")+t.final("hex")},encryptFileUtf8(e){var t=this;return l(regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return console.log("filePath",e),r.next=3,f(e,{encoding:"utf8"});case 3:return n=r.sent,r.abrupt("return",t.encrypt(n));case 5:case"end":return r.stop()}},r,t)}))()},decrypt(e){var t=a.default.createDecipher(this._algorithm,this._secret);return t.update(e,"hex","utf8")+t.final("utf8")},decryptFileUtf8(e){var t=this;return l(regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,f(e,{encoding:"utf8"});case 2:return n=r.sent,r.abrupt("return",t.decrypt(n));case 4:case"end":return r.stop()}},r,t)}))()}}}};var a=c(r(12)),u=c(r(0)),o=c(r(13)),s=c(r(1)),i=c(r(2));function c(e){return e&&e.__esModule?e:{default:e}}function l(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,u){try{var o=t[a](u),s=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}var f=(0,s.default)(u.default.readFile),d=(0,s.default)(o.default.inflate),p=(0,s.default)(o.default.deflate);function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32;return e.length<t?h(`${e}_${e}`,t):e.slice(0,t)}},function(e,t,r){r(7),e.exports=r(8)},function(e,t){e.exports=require("babel-polyfill")},function(e,t,r){"use strict";var n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,u=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,u=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw u}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=m(r(9)),u=m(r(0)),o=m(r(3)),s=m(r(1)),i=m(r(10)),c=m(r(5)),l=m(r(4)),f=m(r(14)),d=m(r(16)),p=m(r(18)),h=m(r(2));function m(e){return e&&e.__esModule?e:{default:e}}var v,g=(0,s.default)(u.default.writeFile),x=(0,a.default)(process.argv.slice(2)),y=n(x._,3),b=y[0],w=y[1];y[2],h.default.cryptography.password||(p.default.noCryptSecret(),process.exit()),(v=regeneratorRuntime.mark(function e(){var t,r,n,a,u,s,m,v,y,k,_,F,R,A,S,O,P,E,j,D,T,B,C,$,N,I,M,L,q,U,H,Y,W,J,K,V,z,G,Q,X;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=x.e||x.extra,r=x.n||x.name,n=x.p||x.password,a=x.i||x.id||x.uuid,u=x.u||x.username,s=x.t||x.text,m=x.f||x.file,v=(0,c.default)(),y=o.default.join(h.default.filepath,h.default.filename),e.t0=b,e.next="add"===e.t0?13:"delete"===e.t0?20:"search"===e.t0?29:"show"===e.t0?43:"update"===e.t0?64:"upgrade"===e.t0?86:"file"===e.t0?93:"decryptfile"===e.t0?95:"recrypt"===e.t0?107:"import"===e.t0?120:"encrypt"===e.t0?145:"decrypt"===e.t0?161:177;break;case 13:if(k=r||w){e.next=16;break}return e.abrupt("return",p.default.error("An account name (-n or --name) parameter is a required at a minimum to add a new account."));case 16:return e.next=18,i.default.addAccount(k,u,n,t);case 18:return p.default.success(`Successfully added account '${k}'!`),e.abrupt("break",178);case 20:if(a){e.next=22;break}return e.abrupt("return",p.default.error("A uuid (-i or --id or --uuid) is a required to delete an account."));case 22:return e.next=24,i.default.deleteAccountByUuid(a);case 24:if(!e.sent){e.next=27;break}return e.abrupt("return",p.default.success(`Successfully deleted account with uuid: '${a}'`));case 27:return p.default.error(`We didn't find an account with uuid: '${a}'`),e.abrupt("break",178);case 29:return _=x.s||x.search||w,e.next=32,l.default.getAndDecryptFlatFile();case 32:return F=e.sent,e.next=35,i.default.searchForAccountsByName(_,F);case 35:return R=e.sent,e.next=38,i.default.searchForAccountsByUsername(_,F);case 38:return A=e.sent,S=[].concat(R.matches).concat(A.matches).sort(i.default.sortByName).reduce(function(e,t){return-1===e.indexOf(t)&&e.push(t),e},[]),O={matches:S,total:R.total},p.default.listAccounts(O.matches,O.total),e.abrupt("break",178);case 43:if(!a){e.next=53;break}return e.next=46,i.default.findAccountByUuid(a);case 46:if(!(P=e.sent)){e.next=50;break}return n||delete P.password,e.abrupt("return",p.default.listSingleAccount(P));case 50:return e.abrupt("return",p.default.error(`We didn't find an account with uuid: ${a}`));case 53:if(!r&&!w){e.next=62;break}return E=r||w,e.next=57,i.default.findAccountByName(E);case 57:if(!(j=e.sent)){e.next=61;break}return n||delete j.password,e.abrupt("return",p.default.listSingleAccount(j));case 61:return e.abrupt("return",p.default.error(`We didn't find an account with name: ${E}`));case 62:return p.default.error("Either a name (-n or --name) or uuid (-i or --id or --uuid) parameter is a required at a minimum to show the details for an account."),e.abrupt("break",178);case 64:if(!a){e.next=75;break}return e.next=67,i.default.findAccountByUuid(a);case 67:if(!(D=e.sent)){e.next=72;break}return e.next=71,i.default.updateAccount(a,{name:r,username:u,password:n,extra:t},D);case 71:return e.abrupt("return",p.default.success(`Successfully updated account with uuid: '${a}'!`));case 72:return e.abrupt("return",p.default.error(`We didn't find an account with uuid: ${a}`));case 75:if(!r){e.next=84;break}return e.next=78,i.default.findAccountByName(r);case 78:if(!(T=e.sent)){e.next=83;break}return e.next=82,i.default.updateAccount(T.uuid,{name:r,username:u,password:n,extra:t},T);case 82:return e.abrupt("return",p.default.success(`Successfully updated account with name: '${r}'!`));case 83:return e.abrupt("return",p.default.error(`We didn't find an account with name: ${r}`));case 84:return p.default.error("Either a name (-n or --name) or uuid (-i or --id or --uuid) parameter is a required at a minimum to show the details for an account."),e.abrupt("break",178);case 86:return e.next=88,l.default.upgradeFrom3To4();case 88:if(!e.sent){e.next=91;break}return e.abrupt("return",p.default.success("Successfully upgraded your flat file to work with version 4+ of hide!"));case 91:return p.default.success("Your local file has already been upgraded to support 4+ version of hide."),e.abrupt("break",178);case 93:return p.default.twoLinesDifferentColors("Your encrypted file is in the following location:",y,"blue","green"),e.abrupt("break",178);case 95:return e.next=97,(0,d.default)().ask("Are you sure you want to decrypt your file and save it to disk (yes/no): ");case 97:if("yes"!==e.sent.toLowerCase()){e.next=106;break}return B=`${y}.json`,e.next=102,l.default.getAndDecryptFlatFile();case 102:return C=e.sent,e.next=105,g(B,JSON.stringify(C));case 105:p.default.success(`Successfully saved your decrypted account data to:\n${B}`);case 106:return e.abrupt("break",178);case 107:return $=o.default.join(h.default.filepath,h.default.filename),N=(0,c.default)({secret:w}),e.next=111,l.default.getAndDecryptFlatFile();case 111:return I=e.sent,M=N.encrypt(JSON.stringify(I)),e.next=115,N.parseData(M);case 115:return L=e.sent,e.next=118,g($,L);case 118:return p.default.success(`Successfully updated your encrypted file with new secret to: ${$}`),e.abrupt("break",178);case 120:if(!(q=x.f||x.filepath||w)||!l.default.doesFileExist(q)){e.next=143;break}return e.next=124,f.default.csv(q);case 124:U=e.sent,H=0,Y=0,W=U.length;case 128:if(!(U.length>0)){e.next=139;break}if(!(J=U.shift()).name){e.next=136;break}return H++,e.next=134,i.default.addAccount(J.name,J.username,J.password,J.extra);case 134:e.next=137;break;case 136:Y++;case 137:e.next=128;break;case 139:return K=`Successfully added ${H} accounts from CSV: ${q}!`,V=Y>0?`Did not add ${Y} accounts because we didn't see an account name ('name' CSV header).`:"",p.default.twoLinesDifferentColors(K,V,"green","red"),e.abrupt("return",p.default.singleLine(`Total number of rows in spreadsheet: ${W}\n`,"blue",0));case 143:return p.default.error(`We can't find filepath provided: ${q||"NO FILE PROVIDED"}`),e.abrupt("break",178);case 145:if(G=void 0,!(z=s||w)){e.next=152;break}G=v.encrypt(z),p.default.success(G),e.next=160;break;case 152:if(!m){e.next=159;break}return e.next=155,v.encryptFileUtf8(m);case 155:G=e.sent,p.default.success(G),e.next=160;break;case 159:p.default.error("Please enter text (-t or --text) or a file path (-f or --file) to encrypt text.");case 160:return e.abrupt("break",178);case 161:if(X=void 0,!(Q=s||w)){e.next=168;break}X=v.decrypt(Q),p.default.success(X),e.next=176;break;case 168:if(!m){e.next=175;break}return e.next=171,v.decryptFileUtf8(m);case 171:X=e.sent,p.default.success(X),e.next=176;break;case 175:p.default.error("Please enter text (-t or --text) or a file path (-f or --file) to encrypt text.");case 176:return e.abrupt("break",178);case 177:p.default.error("I don't recognize what you are trying to do.\nPlease refer to the documentation for what commands I support.");case 178:process.exit(),e.next=185;break;case 181:e.prev=181,e.t1=e.catch(0),"string"==typeof e.t1?p.default.error(e.t1):"TypeError: Bad input string"==e.t1.toString()?(p.default.error(`Uh oh, The error we got is '${e.t1.toString()}'\n\nThis usually means the CRYPT_SECRET is different for the info you're trying to decrypt than was used to encrypt it. Full stack trace below.`),console.log(e.t1)):console.log(e.t1),process.exit();case 185:case"end":return e.stop()}},e,void 0,[[0,181]])}),function(){var e=v.apply(this,arguments);return new Promise(function(t,r){return function n(a,u){try{var o=e[a](u),s=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});t(s)}("next")})})()},function(e,t){e.exports=require("minimist")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(11)),a=u(r(4));function u(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,u){try{var o=t[a](u),s=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}t.default={createUuid:()=>(0,n.default)(),addAccount(e,t,r){var n=arguments,u=this;return o(regeneratorRuntime.mark(function o(){var s,i,c=n.length>3&&void 0!==n[3]?n[3]:"";return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s={[u.createUuid()]:{name:e,username:t||"",password:r||"",extra:c||""}},n.next=3,a.default.getAndDecryptFlatFile();case 3:return i=n.sent,n.next=6,a.default.writeObjToFile(s,i||{});case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},o,u)}))()},updateAccount(e){var t=arguments,r=this;return o(regeneratorRuntime.mark(function n(){var u,o,s=t.length>1&&void 0!==t[1]?t[1]:{},i=t.length>2&&void 0!==t[2]?t[2]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u={[e]:{name:s.name||i.name||"",username:s.username||i.username||"",password:s.password||i.password||"",extra:s.extra||i.extra||""}},t.next=3,a.default.getAndDecryptFlatFile();case 3:return o=t.sent,t.next=6,a.default.writeObjToFile(u,o||{});case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},n,r)}))()},deleteAccountByUuid(e){var t=this;return o(regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.default.getAndDecryptFlatFile();case 2:if((n=t.sent)&&n[e]){t.next=5;break}return t.abrupt("return",!1);case 5:return delete n[e],t.next=8,a.default.writeObjToFile({},n);case 8:return t.abrupt("return",!0);case 9:case"end":return t.stop()}},r,t)}))()},findAccountByUuid(e){var t=this;return o(regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.default.getAndDecryptFlatFile();case 2:if((n=t.sent)&&n[e]){t.next=5;break}return t.abrupt("return",!1);case 5:return t.abrupt("return",Object.assign(n[e],{uuid:e}));case 6:case"end":return t.stop()}},r,t)}))()},findAccountByName(e){var t=this;return o(regeneratorRuntime.mark(function r(){var n,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.default.getAndDecryptFlatFile();case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return",!1);case 5:if(u=Object.keys(n).filter(function(t){return n[t].name.toLowerCase()==e.toLowerCase()})[0]){t.next=8;break}return t.abrupt("return",!1);case 8:return t.abrupt("return",Object.assign(n[u],{uuid:u}));case 9:case"end":return t.stop()}},r,t)}))()},searchForAccountsByName(){var e=arguments,t=this;return o(regeneratorRuntime.mark(function r(){var n=e.length>0&&void 0!==e[0]?e[0]:null,a=e.length>1&&void 0!==e[1]?e[1]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.searchForAccountsByField("name",n,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},r,t)}))()},searchForAccountsByUsername(e){var t=arguments,r=this;return o(regeneratorRuntime.mark(function n(){var a=t.length>1&&void 0!==t[1]?t[1]:null;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.searchForAccountsByField("username",e,a);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},n,r)}))()},searchForAccountsByField(e){var t=arguments,r=this;return o(regeneratorRuntime.mark(function n(){var u,o,s,i=t.length>1&&void 0!==t[1]?t[1]:null,c=t.length>2&&void 0!==t[2]?t[2]:null;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=c,t.t0){t.next=5;break}return t.next=4,a.default.getAndDecryptFlatFile();case 4:t.t0=t.sent;case 5:if(c=t.t0){t.next=8;break}return t.abrupt("return",{matches:[],total:0});case 8:return u=Object.keys(c),o=u.length,s=u.map(function(t){var r=c[t];if(!r)return null;if(i){var n=new RegExp(i,"i");return r[e]&&n.test(r[e])?Object.assign(r,{uuid:t}):null}return Object.assign(r,{uuid:t})}).filter(function(e){return!!e}),t.abrupt("return",{matches:s,total:o});case 12:case"end":return t.stop()}},n,r)}))()},sortByName:(e,t)=>e.name.toLowerCase()<t.name.toLowerCase()?-1:1}},function(e,t){e.exports=require("uuid/v4")},function(e,t){e.exports=require("crypto")},function(e,t){e.exports=require("zlib")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(0)),a=u(r(15));function u(e){return e&&e.__esModule?e:{default:e}}t.default={csv:e=>new Promise(function(t,r){var u=a.default.parse({columns:!0},function(e,n){if(e)return r(e);t(n)});n.default.createReadStream(e).pipe(u)})}},function(e,t){e.exports=require("csv")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return{rl:a.default.createInterface({input:process.stdin,output:process.stdout}),ask(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise(function(n,a){t.rl.question(e,function(e){n(e),r&&t.close()})})},close(){this.rl.close()}}};var n,a=(n=r(17))&&n.__esModule?n:{default:n}},function(e,t){e.exports=require("readline")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a(r(19));var n=a(r(20));function a(e){return e&&e.__esModule?e:{default:e}}var u=function(){};t.default={noCryptSecret(){this.wrapInNewlines(function(){console.log("You don't have environment variable CRYPT_SECRET set.".red),console.log(">export CRYPT_SECRET=[your all time master secret value]".green)})},listSingleAccount(e){var t=this;this.wrapInNewlines(function(){return console.log(t.columnify([e]).green)})},listAccounts(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t.map(function(e){return"string"==typeof e?{name:e}:(delete e.password,e)});this.wrapInNewlines(function(){console.log("I found the following accounts:".blue),console.log(e.columnify(n).green),console.log(`${t.length} of ${r} total accounts returned`.blue)})},twoLinesDifferentColors(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"blue",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"green";this.wrapInNewlines(function(){e.length>0&&console.log(e[r]),t.length>0&&console.log(t[n])})},singleLine(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blue",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.wrapInNewlines(function(){return console.log(e[t])},r)},success(e){this.wrapInNewlines(function(){return console.log(e.green)})},error(e){this.wrapInNewlines(function(){return console.log(e.red)})},wrapInNewlines(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=t-1>0?new Array(t-1).fill("\n").join(""):"";t>0&&console.log(r),e(),t>0&&console.log(r)},columnify:e=>(0,n.default)(e,{minWidth:15})}},function(e,t){e.exports=require("colors")},function(e,t){e.exports=require("columnify")}]);