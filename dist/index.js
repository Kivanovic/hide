#!/usr/bin/env node

!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=6)}([function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("es6-promisify")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={filepath:process.env.NODE_HIDE_FILEPATH||process.env["win32"==process.platform?"USERPROFILE":"HOME"],filename:process.env.NODE_HIDE_FILENAME||"__node-hide-accounts",cryptography:{algorithm:process.env.CRYPT_ALGORITHM||"aes-256-ctr",password:process.env.CRYPT_SECRET}}},function(e,t){e.exports=require("path")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(r(0)),a=o(r(3)),u=o(r(1)),s=o(r(5)),i=o(r(2));function o(e){return e&&e.__esModule?e:{default:e}}function c(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,u){try{var s=t[a](u),i=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(i).then(function(e){n("next",e)},function(e){n("throw",e)});e(i)}("next")})}}var f=(0,u.default)(n.default.mkdir),l=(0,u.default)(n.default.writeFile),d=(0,u.default)(n.default.readFile),p=(0,s.default)();t.default={filepath:a.default.join(i.default.filepath,i.default.filename),upgradeFrom3To4(){var e=this;return c(regeneratorRuntime.mark(function t(){var r,n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.doesDirectoryExist(i.default.filepath)){t.next=13;break}if(!e.doesFileExist(e.filepath)){t.next=13;break}return t.next=4,d(e.filepath);case 4:return r=t.sent,t.next=7,p.parseData(r.toString("utf8"),!1);case 7:if(1!==(n=t.sent).toString("utf8").split(":").length){t.next=13;break}return a=JSON.parse(p.deprecated.decrypt(n.toString("utf8"))),t.next=12,e.writeObjToFile(a);case 12:return t.abrupt("return",!0);case 13:return t.abrupt("return",!1);case 14:case"end":return t.stop()}},t,e)}))()},getAndDecryptFlatFile(){var e=this;return c(regeneratorRuntime.mark(function t(){var r,n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.doesDirectoryExist(i.default.filepath)){t.next=25;break}if(!e.doesFileExist(e.filepath)){t.next=22;break}return t.next=4,d(e.filepath);case 4:if(0!==(r=t.sent).length){t.next=9;break}return t.abrupt("return",null);case 9:return t.next=11,p.parseData(r.toString("utf8"),!1);case 11:return n=t.sent,t.prev=12,a=JSON.parse(p.decrypt(n.toString("utf8"))),t.abrupt("return",a);case 17:throw t.prev=17,t.t0=t.catch(12),`We're having a problem parsing your flat file at '${e.filepath}'.\n              This is likely due to a different master password, environment variable CRYPT_SECRET,\n              being used that previously was set. Make sure you have the correct\n              secret you used before and try again.`.replace(/\n\s+/g,"\n");case 20:t.next=25;break;case 22:return t.next=24,l(e.filepath,"");case 24:return t.abrupt("return",null);case 25:return t.next=27,f(i.default.filepath);case 27:return t.next=29,l(e.filepath,"");case 29:return t.abrupt("return","");case 30:case"end":return t.stop()}},t,e,[[12,17]])}))()},writeObjToFile(e){var t=arguments,r=this;return c(regeneratorRuntime.mark(function n(){var a,u,s,i=t.length>1&&void 0!==t[1]?t[1]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=Object.assign(i,e),u=p.encrypt(JSON.stringify(a)),t.next=4,p.parseData(u);case 4:return s=t.sent,t.next=7,l(r.filepath,s);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}},n,r)}))()},doesDirectoryExist(e){try{return n.default.statSync(e).isDirectory()}catch(e){return!1}},doesFileExist(e){try{return n.default.statSync(e).isFile()}catch(e){return!1}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,u=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,u=e}finally{try{!n&&i.return&&i.return()}finally{if(a)throw u}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.algorithm||o.default.cryptography.algorithm,r=e.secret||o.default.cryptography.password;return{_algorithm:t,_secret:r,encrypt(e){var t=function(e){return{iv:a.default.randomBytes(16),key:e instanceof Buffer?e:Buffer.from(e)}}(h(this._secret,this.getAlgorithmKeyLength())),r=t.iv,n=t.key,u=a.default.createCipheriv(this._algorithm,n,r),s=u.update(e,"utf8","hex");return`${s+=u.final("hex")}:${r.toString("hex")}`},encryptFileUtf8(e){var t=this;return f(regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,l(e,{encoding:"utf8"});case 2:return n=r.sent,r.next=5,t.encrypt(n);case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}},r,t)}))()},decrypt(e){var t=e.split(":"),r=n(t,2),u=r[0],s=r[1],i=Buffer.from(s,"hex"),o=h(this._secret,this.getAlgorithmKeyLength()),c=o instanceof Buffer?o:Buffer.from(o),f=a.default.createDecipheriv(this._algorithm,c,i);return f.update(u,"hex","utf8")+f.final("utf8")},decryptFileUtf8(e){var t=this;return f(regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,l(e,{encoding:"utf8"});case 2:return n=r.sent,r.next=5,t.decrypt(n);case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}},r,t)}))()},stringToHash(e){var t=a.default.createHash("md5");return t.update(e),t.digest("hex")},fileToHash(e){var t=this;return f(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise(function(t,r){var n=a.default.createHash("md5"),s=u.default.ReadStream(e);s.on("data",function(e){return n.update(e)}),s.on("error",r),s.on("end",function(){return t(n.digest("hex"))})});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},r,t)}))()},parseData(e){var t=arguments,r=this;return f(regeneratorRuntime.mark(function n(){var a,u=!(t.length>1&&void 0!==t[1])||t[1];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=u,t.next=!1===t.t0?4:7;break;case 4:return t.next=6,d(Buffer.from(e,"base64"));case 6:return t.abrupt("return",t.sent);case 7:return t.next=9,p(e);case 9:return a=t.sent,t.abrupt("return",Buffer.from(a).toString("base64"));case 11:case"end":return t.stop()}},n,r)}))()},getAlgorithmKeyLength(){return{"des-ede3":24,aes128:16,"aes-128-cbc":16,aes192:24,aes256:32}[this._algorithm]},deprecated:{_algorithm:t,_secret:r,encrypt(e){var t=a.default.createCipher(this._algorithm,this._secret);return t.update(e,"utf8","hex")+t.final("hex")},encryptFileUtf8(e){var t=this;return f(regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,l(e,{encoding:"utf8"});case 2:return n=r.sent,r.abrupt("return",t.encrypt(n));case 4:case"end":return r.stop()}},r,t)}))()},decrypt(e){var t=a.default.createDecipher(this._algorithm,this._secret);return t.update(e,"hex","utf8")+t.final("utf8")},decryptFileUtf8(e){var t=this;return f(regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,l(e,{encoding:"utf8"});case 2:return n=r.sent,r.abrupt("return",t.decrypt(n));case 4:case"end":return r.stop()}},r,t)}))()}}}};var a=c(r(12)),u=c(r(0)),s=c(r(13)),i=c(r(1)),o=c(r(2));function c(e){return e&&e.__esModule?e:{default:e}}function f(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,u){try{var s=t[a](u),i=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(i).then(function(e){n("next",e)},function(e){n("throw",e)});e(i)}("next")})}}var l=(0,i.default)(u.default.readFile),d=(0,i.default)(s.default.inflate),p=(0,i.default)(s.default.deflate);function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32;return e.length<t?h(`${e}_${e}`,t):e.slice(0,t)}},function(e,t,r){r(7),e.exports=r(8)},function(e,t){e.exports=require("babel-polyfill")},function(e,t,r){"use strict";var n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,u=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,u=e}finally{try{!n&&i.return&&i.return()}finally{if(a)throw u}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=m(r(9)),u=m(r(0)),s=m(r(3)),i=m(r(1)),o=m(r(10)),c=m(r(5)),f=m(r(4)),l=m(r(14)),d=m(r(16)),p=m(r(18)),h=m(r(2));function m(e){return e&&e.__esModule?e:{default:e}}var v,g=(0,i.default)(u.default.writeFile),x=(0,a.default)(process.argv.slice(2)),y=n(x._,3),b=y[0],w=y[1];y[2],h.default.cryptography.password||["file","version"].includes(b)||(p.default.noCryptSecret(),process.exit()),(v=regeneratorRuntime.mark(function e(){var t,n,a,u,i,m,v,y,k,_,F,R,A,S,O,E,P,j,D,T,B,C,$,N,I,M,q,L,U,H,Y,W,J,K,V,z,G,Q,X,Z;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=x.e||x.extra,n=x.n||x.name,a=x.p||x.password,u=x.i||x.id||x.uuid,i=x.u||x.username,m=x.t||x.text,v=x.f||x.file,y=(0,c.default)(),k=s.default.join(h.default.filepath,h.default.filename),e.t0=b,e.next="file"===e.t0?13:"version"===e.t0?15:"add"===e.t0?17:"delete"===e.t0?24:"search"===e.t0?33:"show"===e.t0?47:"update"===e.t0?68:"upgrade"===e.t0?90:"decryptfile"===e.t0?97:"recrypt"===e.t0?109:"import"===e.t0?122:"encrypt"===e.t0?147:"decrypt"===e.t0?163:179;break;case 13:return p.default.twoLinesDifferentColors("Your encrypted file is in the following location:",k,"blue","green"),e.abrupt("break",180);case 15:return p.default.success(r(21)("package.json").version,!1),e.abrupt("break",180);case 17:if(_=n||w){e.next=20;break}return e.abrupt("return",p.default.error("An account name (-n or --name) parameter is a required at a minimum to add a new account."));case 20:return e.next=22,o.default.addAccount(_,i,a,t);case 22:return p.default.success(`Successfully added account '${_}'!`),e.abrupt("break",180);case 24:if(u){e.next=26;break}return e.abrupt("return",p.default.error("A uuid (-i or --id or --uuid) is a required to delete an account."));case 26:return e.next=28,o.default.deleteAccountByUuid(u);case 28:if(!e.sent){e.next=31;break}return e.abrupt("return",p.default.success(`Successfully deleted account with uuid: '${u}'`));case 31:return p.default.error(`We didn't find an account with uuid: '${u}'`),e.abrupt("break",180);case 33:return F=x.s||x.search||w,e.next=36,f.default.getAndDecryptFlatFile();case 36:return R=e.sent,e.next=39,o.default.searchForAccountsByName(F,R);case 39:return A=e.sent,e.next=42,o.default.searchForAccountsByUsername(F,R);case 42:return S=e.sent,O=[].concat(A.matches).concat(S.matches).sort(o.default.sortByName).reduce(function(e,t){return-1===e.indexOf(t)&&e.push(t),e},[]),E={matches:O,total:A.total},p.default.listAccounts(E.matches,E.total),e.abrupt("break",180);case 47:if(!u){e.next=57;break}return e.next=50,o.default.findAccountByUuid(u);case 50:if(!(P=e.sent)){e.next=54;break}return a||delete P.password,e.abrupt("return",p.default.listSingleAccount(P));case 54:return e.abrupt("return",p.default.error(`We didn't find an account with uuid: ${u}`));case 57:if(!n&&!w){e.next=66;break}return j=n||w,e.next=61,o.default.findAccountByName(j);case 61:if(!(D=e.sent)){e.next=65;break}return a||delete D.password,e.abrupt("return",p.default.listSingleAccount(D));case 65:return e.abrupt("return",p.default.error(`We didn't find an account with name: ${j}`));case 66:return p.default.error("Either a name (-n or --name) or uuid (-i or --id or --uuid) parameter is a required at a minimum to show the details for an account."),e.abrupt("break",180);case 68:if(!u){e.next=79;break}return e.next=71,o.default.findAccountByUuid(u);case 71:if(!(T=e.sent)){e.next=76;break}return e.next=75,o.default.updateAccount(u,{name:n,username:i,password:a,extra:t},T);case 75:return e.abrupt("return",p.default.success(`Successfully updated account with uuid: '${u}'!`));case 76:return e.abrupt("return",p.default.error(`We didn't find an account with uuid: ${u}`));case 79:if(!n){e.next=88;break}return e.next=82,o.default.findAccountByName(n);case 82:if(!(B=e.sent)){e.next=87;break}return e.next=86,o.default.updateAccount(B.uuid,{name:n,username:i,password:a,extra:t},B);case 86:return e.abrupt("return",p.default.success(`Successfully updated account with name: '${n}'!`));case 87:return e.abrupt("return",p.default.error(`We didn't find an account with name: ${n}`));case 88:return p.default.error("Either a name (-n or --name) or uuid (-i or --id or --uuid) parameter is a required at a minimum to show the details for an account."),e.abrupt("break",180);case 90:return e.next=92,f.default.upgradeFrom3To4();case 92:if(!e.sent){e.next=95;break}return e.abrupt("return",p.default.success("Successfully upgraded your flat file to work with version 4+ of hide!"));case 95:return p.default.success("Your local file has already been upgraded to support 4+ version of hide."),e.abrupt("break",180);case 97:return e.next=99,(0,d.default)().ask("Are you sure you want to decrypt your file and save it to disk (yes/no): ");case 99:if("yes"!==e.sent.toLowerCase()){e.next=108;break}return C=`${k}.json`,e.next=104,f.default.getAndDecryptFlatFile();case 104:return $=e.sent,e.next=107,g(C,JSON.stringify($));case 107:p.default.success(`Successfully saved your decrypted account data to:\n${C}`);case 108:return e.abrupt("break",180);case 109:return N=s.default.join(h.default.filepath,h.default.filename),I=(0,c.default)({secret:w}),e.next=113,f.default.getAndDecryptFlatFile();case 113:return M=e.sent,q=I.encrypt(JSON.stringify(M)),e.next=117,I.parseData(q);case 117:return L=e.sent,e.next=120,g(N,L);case 120:return p.default.success(`Successfully updated your encrypted file with new secret to: ${N}`),e.abrupt("break",180);case 122:if(!(U=x.f||x.filepath||w)||!f.default.doesFileExist(U)){e.next=145;break}return e.next=126,l.default.csv(U);case 126:H=e.sent,Y=0,W=0,J=H.length;case 130:if(!(H.length>0)){e.next=141;break}if(!(K=H.shift()).name){e.next=138;break}return Y++,e.next=136,o.default.addAccount(K.name,K.username,K.password,K.extra);case 136:e.next=139;break;case 138:W++;case 139:e.next=130;break;case 141:return V=`Successfully added ${Y} accounts from CSV: ${U}!`,z=W>0?`Did not add ${W} accounts because we didn't see an account name ('name' CSV header).`:"",p.default.twoLinesDifferentColors(V,z,"green","red"),e.abrupt("return",p.default.singleLine(`Total number of rows in spreadsheet: ${J}\n`,"blue",0));case 145:return p.default.error(`We can't find filepath provided: ${U||"NO FILE PROVIDED"}`),e.abrupt("break",180);case 147:if(Q=void 0,!(G=m||w)){e.next=154;break}Q=y.encrypt(G),p.default.success(Q),e.next=162;break;case 154:if(!v){e.next=161;break}return e.next=157,y.encryptFileUtf8(v);case 157:Q=e.sent,p.default.success(Q),e.next=162;break;case 161:p.default.error("Please enter text (-t or --text) or a file path (-f or --file) to encrypt text.");case 162:return e.abrupt("break",180);case 163:if(Z=void 0,!(X=m||w)){e.next=170;break}Z=y.decrypt(X),p.default.success(Z),e.next=178;break;case 170:if(!v){e.next=177;break}return e.next=173,y.decryptFileUtf8(v);case 173:Z=e.sent,p.default.success(Z),e.next=178;break;case 177:p.default.error("Please enter text (-t or --text) or a file path (-f or --file) to encrypt text.");case 178:return e.abrupt("break",180);case 179:p.default.error("I don't recognize what you are trying to do.\nPlease refer to the documentation for what commands I support.");case 180:process.exit(),e.next=187;break;case 183:e.prev=183,e.t1=e.catch(0),"string"==typeof e.t1?p.default.error(e.t1):"TypeError: Bad input string"==e.t1.toString()?(p.default.error(`Uh oh, The error we got is '${e.t1.toString()}'\n\nThis usually means the CRYPT_SECRET is different for the info you're trying to decrypt than was used to encrypt it. Full stack trace below.`),console.log(e.t1)):console.log(e.t1),process.exit();case 187:case"end":return e.stop()}},e,void 0,[[0,183]])}),function(){var e=v.apply(this,arguments);return new Promise(function(t,r){return function n(a,u){try{var s=e[a](u),i=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(i).then(function(e){n("next",e)},function(e){n("throw",e)});t(i)}("next")})})()},function(e,t){e.exports=require("minimist")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(11)),a=u(r(4));function u(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){return function n(a,u){try{var s=t[a](u),i=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(i).then(function(e){n("next",e)},function(e){n("throw",e)});e(i)}("next")})}}t.default={createUuid:()=>(0,n.default)(),addAccount(e,t,r){var n=arguments,u=this;return s(regeneratorRuntime.mark(function s(){var i,o,c=n.length>3&&void 0!==n[3]?n[3]:"";return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i={[u.createUuid()]:{name:e,username:t||"",password:r||"",extra:c||""}},n.next=3,a.default.getAndDecryptFlatFile();case 3:return o=n.sent,n.next=6,a.default.writeObjToFile(i,o||{});case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},s,u)}))()},updateAccount(e){var t=arguments,r=this;return s(regeneratorRuntime.mark(function n(){var u,s,i=t.length>1&&void 0!==t[1]?t[1]:{},o=t.length>2&&void 0!==t[2]?t[2]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u={[e]:{name:i.name||o.name||"",username:i.username||o.username||"",password:i.password||o.password||"",extra:i.extra||o.extra||""}},t.next=3,a.default.getAndDecryptFlatFile();case 3:return s=t.sent,t.next=6,a.default.writeObjToFile(u,s||{});case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},n,r)}))()},deleteAccountByUuid(e){var t=this;return s(regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.default.getAndDecryptFlatFile();case 2:if((n=t.sent)&&n[e]){t.next=5;break}return t.abrupt("return",!1);case 5:return delete n[e],t.next=8,a.default.writeObjToFile({},n);case 8:return t.abrupt("return",!0);case 9:case"end":return t.stop()}},r,t)}))()},findAccountByUuid(e){var t=this;return s(regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.default.getAndDecryptFlatFile();case 2:if((n=t.sent)&&n[e]){t.next=5;break}return t.abrupt("return",!1);case 5:return t.abrupt("return",Object.assign(n[e],{uuid:e}));case 6:case"end":return t.stop()}},r,t)}))()},findAccountByName(e){var t=this;return s(regeneratorRuntime.mark(function r(){var n,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.default.getAndDecryptFlatFile();case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return",!1);case 5:if(u=Object.keys(n).filter(function(t){return n[t].name.toLowerCase()==e.toLowerCase()})[0]){t.next=8;break}return t.abrupt("return",!1);case 8:return t.abrupt("return",Object.assign(n[u],{uuid:u}));case 9:case"end":return t.stop()}},r,t)}))()},searchForAccountsByName(){var e=arguments,t=this;return s(regeneratorRuntime.mark(function r(){var n=e.length>0&&void 0!==e[0]?e[0]:null,a=e.length>1&&void 0!==e[1]?e[1]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.searchForAccountsByField("name",n,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},r,t)}))()},searchForAccountsByUsername(e){var t=arguments,r=this;return s(regeneratorRuntime.mark(function n(){var a=t.length>1&&void 0!==t[1]?t[1]:null;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.searchForAccountsByField("username",e,a);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},n,r)}))()},searchForAccountsByField(e){var t=arguments,r=this;return s(regeneratorRuntime.mark(function n(){var u,s,i,o=t.length>1&&void 0!==t[1]?t[1]:null,c=t.length>2&&void 0!==t[2]?t[2]:null;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=c,t.t0){t.next=5;break}return t.next=4,a.default.getAndDecryptFlatFile();case 4:t.t0=t.sent;case 5:if(c=t.t0){t.next=8;break}return t.abrupt("return",{matches:[],total:0});case 8:return u=Object.keys(c),s=u.length,i=u.map(function(t){var r=c[t];if(!r)return null;if(o){var n=new RegExp(o,"i");return r[e]&&n.test(r[e])?Object.assign(r,{uuid:t}):null}return Object.assign(r,{uuid:t})}).filter(function(e){return!!e}),t.abrupt("return",{matches:i,total:s});case 12:case"end":return t.stop()}},n,r)}))()},sortByName:(e,t)=>e.name.toLowerCase()<t.name.toLowerCase()?-1:1}},function(e,t){e.exports=require("uuid/v4")},function(e,t){e.exports=require("crypto")},function(e,t){e.exports=require("zlib")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(r(0)),a=u(r(15));function u(e){return e&&e.__esModule?e:{default:e}}t.default={csv:e=>new Promise(function(t,r){var u=a.default.parse({columns:!0},function(e,n){if(e)return r(e);t(n)});n.default.createReadStream(e).pipe(u)})}},function(e,t){e.exports=require("csv")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return{rl:a.default.createInterface({input:process.stdin,output:process.stdout}),ask(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise(function(n,a){t.rl.question(e,function(e){n(e),r&&t.close()})})},close(){this.rl.close()}}};var n,a=(n=r(17))&&n.__esModule?n:{default:n}},function(e,t){e.exports=require("readline")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a(r(19));var n=a(r(20));function a(e){return e&&e.__esModule?e:{default:e}}var u=function(){};t.default={noCryptSecret(){this.wrapInNewlines(function(){console.log("You don't have environment variable CRYPT_SECRET set.".red),console.log(">export CRYPT_SECRET=[your all time master secret value]".green)})},listSingleAccount(e){var t=this;this.wrapInNewlines(function(){return console.log(t.columnify([e]).green)})},listAccounts(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t.map(function(e){return"string"==typeof e?{name:e}:(delete e.password,e)});this.wrapInNewlines(function(){console.log("I found the following accounts:".blue),console.log(e.columnify(n).green),console.log(`${t.length} of ${r} total accounts returned`.blue)})},twoLinesDifferentColors(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"blue",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"green";this.wrapInNewlines(function(){e.length>0&&console.log(e[r]),t.length>0&&console.log(t[n])})},singleLine(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blue",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.wrapInNewlines(function(){return console.log(e[t])},r)},success(e){var t=function(e){return e()};(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(t=this.wrapInNewlines),t(function(){return console.log(e.green)})},error(e){this.wrapInNewlines(function(){return console.log(e.red)})},wrapInNewlines(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=t-1>0?new Array(t-1).fill("\n").join(""):"";t>0&&console.log(r),e(),t>0&&console.log(r)},columnify:e=>(0,n.default)(e,{minWidth:15})}},function(e,t){e.exports=require("colors")},function(e,t){e.exports=require("columnify")},function(e,t){e.exports=require("root-require")}]);